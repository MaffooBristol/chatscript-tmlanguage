{
  "fileTypes": [
    "top",
    "tbl",
    "tst"
  ],
  "name": "ChatScript",
  "patterns": [
    {
      "comment": "System variables (date & time & numbers)",
      "match": "(\\%)(?i:(date|daynumber|fulltime|timenumbers|leapyear|daylightsavings|minute|month|monthname|second|volleytime|week|year|rand|zulutime|day|time))",
      "name": "constant.numeric.ChatScript"
    },
    {
      "comment": "System variables (user input)",
      "match": "(\\%)(?i:(inputrejoinder|bot|revisedinput|command|foreign|impliedyou|input|ip|length|more|morequestion|originalinput|originalsentence|parsed|question|quotation|sentence|tense|userfirstline|user|userinput|voice))",
      "name": "constant.numeric.ChatScript"
    },
    {
      "comment": "System variables (chatbot output)",
      "match": "(\\%)(?i:(httpresponse|response|all|document|fact|freetext|freedict|freefact|maxmatchvariables|maxfactsets|host|regression|server|rule|topic|actualtopic|trace|outputrejoinder|lastquestion))",
      "name": "constant.numeric.ChatScript"
    },
    {
      "comment": "System variables (build data)",
      "match": "(\\%)(?i:(dict|engine|os|script|version|pid|restart|language))",
      "name": "constant.numeric.ChatScript"
    },
    {
      "comment": "Interchange variables",
      "match": "(\\$)(?i:(cs_afterreset|cs_beforereset|cs_token|cs_response|cs_jsontimeout|cs_crashmsg|cs_abstract|cs_looplimit|cs_trace|cs_control_pre|cs_prepass|cs_control_main|cs_control_post|botprompt|userprompt|cs_crashmsg|cs_language|cs_token|cs_abstract|cs_prepass|cs_wildcardseparator|cs_userfactlimit|cs_response|cs_randindex|cs_utcoffset|cs_randindex|cs_bot|cs_login|\\$db_error|\\$findtext_start|\\$tcpopen_error|\\$document|cs_externaltag|cs_usermessagelimit|\\$findtext_word|\\$csmatch_start|\\$csmatch_end|cs_botid))",
      "name": "constant.numeric.ChatScript"
    },
    {
      "captures": {
        "2": {
          "name": "keyword.numeric.ChatScript"
        },
        "3": {
          "name": "constant.language.ChatScript"
        }
      },
      "comment": "Input capture variables",
      "match": "(\\s*)(\\'?)(_\\d+)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Position variable",
      "match": "@[\\w,\\d,\\-,_]+[\\-,\\+]?",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "User transient variables",
      "match": "\\$\\$\\w+",
      "name": "variable.parameter.ChatScript"
    },
    {
      "captures": {
        "1": {
          "name": "variable.parameter.ChatScript"
        },
        "2": {
          "name": "none.ChatScript"
        }
      },
      "comment": "User variables",
      "match": "(\\$[a-zA-Z\\d_-]+)(\\.[\\w$-]+)?",
      "name": "none.ChatScript"
    },
    {
      "begin": "((if|else\\sif)(?:\\s*)(?=\\(+))|(else)(?:\\s*)(?=\\{|\n)",
      "beginCaptures": {
        "2": {
          "name": "keyword.numeric.ChatScript"
        },
        "3": {
          "name": "keyword.numeric.ChatScript"
        }
      },
      "comment": "Execution flow",
      "end": "\\)",
      "name": "none.ChatScript",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": "(\\!|==|\\b(AND|OR)\\b|>=|<=|!=|>|<|\\?)",
          "name": "keyword.numeric.ChatScript"
        }
      ]
    },
    {
      "comment": "Integers",
      "match": "(?<!_)\\-?\\d+(?![\\w\\-+?&])\\b",
      "name": "constant.numeric.ChatScript"
    },
    {
      "comment": "Boolean & state",
      "match": "\\b(null|true|false)\\b[^\"-=\\$%&\\?]",
      "name": "constant.numeric.ChatScript"
    },
    {
      "comment": "Assigment",
      "match": "(?!\\s)((=(?!=)|\\+=|-=|\\*=|/=|\\%=|\\*\\*=|<<=|>>=|<<|>>|&=|\\^=|\\|=|\\|))",
      "name": "keyword.numeric.ChatScript"
    },
    {
      "comment": "Operators",
      "match": "((?<![/,'\";=])\\B(-|\\+|/|\\*|%)(?![/,'\";=])\\B)",
      "name": "keyword.numeric.ChatScript"
    },
    {
      "comment": "Response control",
      "match": "#(RESPONSE_UPPERSTART|RESPONSE_REMOVESPACEBEFORECOMMA|RESPONSE_ALTERUNDERSCORES|ALL_RESPONSES|RESPONSE_REMOVETILDE)",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Token control",
      "match": "#(DO_SUBSTITUTE_SYSTEM|DO_ESSENTIALS|DO_SUBSTITUTES|DO_CONTRACTIONS|DO_INTERJECTIONS|DO_BRITISH|DO_SPELLING|DO_TEXTING|DO_NOISE|DO_PRIVATE|DO_NUMBER_MERGE|DO_PROPERNAME_MERGE|DO_DATE_MERGE|NO_PROPER_SPELLCHECK|NO_LOWERCASE_PROPER_MERGE|DO_SPELLCHECK|DO_INTERJECTION_SPLITTING|DO_PARSE|DO_POSTAG|NO_IMPERATIVE|NO_WITHIN|NO_SENTENCE_END|NO_HYPHEN_END|NO_COLON_END|NO_SEMICOLON_END|STRICT_CASING|ONLY_LOWERCASE|TOKEN_AS_IS|SPLIT_QUOTE|UNTOUCHED_INPUT|JSON_DIRECT_FROM_OOB|DO_CONDITIONAL_POSTAG|NO_ERASE|DO_SPLIT_UNDERSCORE|MARK_LOWER|NO_INFER_QUESTION|LEAVE_QUOTE|JSON_DIRECT_OOB|NO_FIX_UTF|QUESTIONMARK)",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Print output codes",
      "match": "(?!\\w)(#*)(OUTPUT_RAW|OUTPUT_RETURNVALUE_ONLY|OUTPUT_NOCOMMANUMBER|OUTPUT_NOQUOTES|OUTPUT_NOUNDERSCORE)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "End/nofail codes",
      "match": "(?!\\w)(#*)(NOFAIL|FAIL|CALL|RULE|LOOP|TOPIC|SENTENCE|INPUT|PLAN)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "TCP open",
      "match": "(?!\\w)(#*)(POST|GET|TRACE_TCP|POSTU|GETU)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Logs",
      "match": "(?!\\w)(#*)(FILE|OPEN|CLOSE)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Json",
      "match": "(?!\\w)(#*)(INDEX|VALUE)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Words",
      "match": "(?!\\w)(#*)(NOUN|VERB|ADJECTIVE|ADVERB|PREPOSITION)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Facts",
      "match": "(?!\\w)(#*)(direct_s|direct_v|direct_o|direct_sv|direct_so|direct_vo|direct_svo|Unipropogate|FACTDEAD)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "POS",
      "match": "(?!\\w)(#*)(NOUN|VERB|ESSENTIAL_POS|ADJECTIVE|ADVERB|BASIC_POS|PREPOSITION|ESSENTIAL_FLAGS|CONJUNCTION_COORDINATE|CONJUNCTION_SUBORDINATE|CONJUNCTION|PREDETERMINER|DETERMINER|POSSESSIVE|PRONOUN_POSSESSIVE|POSSESSIVE_BITS|DETERMINER_BITS|COMMA|REQUIRE_CONCEPT|PAREN|PUNCTUATION|QUOTE|CURRENCY|ADJECTIVE_NORMAL|ADJECTIVE_NUMBER|ADJECTIVE_NOUN|ADJECTIVE_PARTICIPLE|ADJECTIVE_BITS|INTERJECTION|THERE_EXISTENTIAL|FOREIGN_WORD|TO_INFINITIVE|NOUN_ADJECTIVE|NOUN_SINGULAR|NOUN_PLURAL|NOUN_PROPER_SINGULAR|NOUN_PROPER_PLURAL|NOUN_GERUND|NOUN_NUMBER|NOUN_INFINITIVE|NOUN_PROPER|NORMAL_NOUN_BITS|NOUN_BITS|VERB_PRESENT|VERB_PRESENT_3PS|VERB_PRESENT_PARTICIPLE|VERB_PAST|VERB_PAST_PARTICIPLE|VERB_INFINITIVE|PARTICLE|VERB_BITS|PRONOUN_SUBJECT|PRONOUN_OBJECT|PRONOUN_BITS|AUX_DO|AUX_HAVE|AUX_BE|AUX_VERB_PRESENT|AUX_VERB_FUTURE|AUX_VERB_PAST|AUX_VERB_TENSES|AUX_VERB|STARTTAGS|AS_IS)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Other special words",
      "match": "(?!\\w)(#*)(TOPRULES|PENDING|START|END|BOTH|BOT|USER|AUTOSPACE|HAS_SUBSTITUTE|CONCEPT|TOPIC)\\b",
      "name": "constant.language.ChatScript"
    },
    {
      "begin": "(\\^(?i:(addtopic|available|cleartopics|counttopics|gambit|getrule|hasgambit|keep|lastused|next|poptopic|refine|rejoinder|respond|retry|reuse|sequence|setrejoinder|topicflags)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (topics)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(mark|unmark|position|setposition|marked)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (marking)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(analyze|capitalized|input|original|position|removetokenflags|settokenflags|setwildcardindex|actualinputrange)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (input)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(compute|timefromseconds|timeinfofromseconds|timetoeconds)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (number)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(flushoutput|insertprint|keephistory|lastsaid|print|preprint|repeat|reviseOutput|savesentence|restoresentence|notrace)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (output)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(response|responsequestion|responseruleid)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (output access)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(postprintbefore|postprintafter|csboot|csshotdown)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (print)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(argument|command|end|eval|loop|fail|load|match|nofail|notnull|norejoinder|nottrace|return|addcontext|incontext)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (control flow)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(system|popen|tcpopen|export|import|debug|log|environment)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (external access)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(jsonarrayinsert|jsonarraydelete|jsoncreate|jsondelete|jsongather|jsonobjectinsert|jsonopen|jsonprint|jsonwrite|jsonparse|jsonpath|jsonarraysize|jsonobjectinsert|jsonlabel|jsonundecodestring|jsoncopy|jsonkind|jsonreadcvs|jsontree)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (json)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "none.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(burst|words|canon|explode|extract|findtext|flags|intersectwords|join|properties|pos|decodeinputtoken|decodepos|partofspeech|role|tally|rhyme|substitute|spell|sexed|uppercase|addproperty|define|hasanyproperty|hasallproperty|removeinternalflag|removeproperty|walkdictionary|iterator|wordinconcept|setoriginal|setcanon|settag|setrole|tokenize)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (word manipulation)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(disable|enable|length|pick|reset|clearcontext|authorized|callstack)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (multipurpose)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^(?i:(result|findfact|query|first|last|pick|sort|delete|length|nth|unpackfactref|save|addproperty|conceptlist|createattribute|createfact|writefact|revisefact|field|find|findmarkedfact|flushfacts|gambittopics|intersectfacts|keywordtopics|last|makereal|next|pendingtopics|pick|querytopics|removeproperty|reset|query|save|unduplicate|uniquefacts|unpackfactref|importfacts|serialize|deserialize|match)))(\\()",
      "beginCaptures": {
        "1": {
          "name": "support.function.ChatScript"
        }
      },
      "comment": "Built-in functions (facts)",
      "contentName": "variable.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "begin": "(\\^([\\w, \\-, \\_]+))(?:\\()",
      "beginCaptures": {
        "1": {
          "name": "none.ChatScript"
        }
      },
      "comment": "User defined functions",
      "contentName": "none.ChatScript",
      "end": "\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "variable.ChatScript"
        }
      ]
    },
    {
      "comment": "Escaped characters",
      "match": "((\\\\[\\w,\\d,\\[,\\],\\(,$,-,\\+,_]+)|(\\\\([n,r,t,',\"]))|(\\\\\\)))",
      "name": "string.source.ChatScript"
    },
    {
      "begin": "(^s:|^u:|^t:|\\?:)\\s+([A-Z,\\-,\\_,\\d]*)\\s*\\((\\_?)",
      "beginCaptures": {
        "1": {
          "name": "entity.name.function.ChatScript"
        },
        "2": {
          "name": "entity.other.inherited-class.ChatScript"
        },
        "3": {
          "name": "keyword.numeric.ChatScript"
        }
      },
      "comment": "CS symbols rules",
      "contentName": "none.ChatScript",
      "end": "(?<!\\\\)\\)",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "captures": {
            "1": {
              "name": "keyword.numeric.ChatScript"
            },
            "2": {
              "name": "string.source.ChatScript"
            }
          },
          "match": "(\\*|<<|>>|==|\\!\\=|\\!|\\?|\\[|\\]|\\{|\\}|\\\"|'|<|>|_(?![a-z]))|(\\w+|-|~)",
          "name": "keyword.numeric.ChatScript"
        }
      ]
    },
    {
      "comment": "Gambit with no parentesis",
      "match": "^t:\\s",
      "name": "entity.name.function.ChatScript"
    },
    {
      "begin": "([a-q]:)\\s+([A-Z,\\-,\\_,\\d]*)\\s*(\\()",
      "beginCaptures": {
        "1": {
          "name": "entity.name.function.ChatScript"
        },
        "2": {
          "name": "entity.other.inherited-class.ChatScript"
        }
      },
      "comment": "Rejoinder rules",
      "contentName": "none.ChatScript",
      "end": "(\\))",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "captures": {
            "1": {
              "name": "keyword.numeric.ChatScript"
            },
            "2": {
              "name": "string.source.ChatScript"
            }
          },
          "match": "(\\*|<<|>>|==|\\!\\=|\\!|\\?|\\[|\\]|\\{|\\}|\\\"|'|<|>|_(?![a-z]))|(\\w|-|~+)",
          "name": "keyword.numeric.ChatScript"
        }
      ]
    },
    {
      "captures": {
        "2": {
          "name": "entity.other.inherited-class.ChatScript"
        }
      },
      "comment": "Invoked rules",
      "match": "(~[\\w,\\-,\\_]+)\\.([A-Z,\\-,\\_,\\d]*)",
      "name": "none.ChatScript"
    },
    {
      "begin": "(\\^(\")([\\s\\w\\W])*?)",
      "comment": "Multiline double quotes strings elements",
      "end": "(\")",
      "name": "string.source.ChatScript",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "string.source.ChatScript"
        }
      ]
    },
    {
      "comment": "Strings double quotes elements",
      "match": "(\\^(\").+(\"))",
      "name": "string.source.ChatScript"
    },
    {
      "begin": "(\\^(')([\\s\\w\\W])*?)",
      "comment": "Multiline single quotes strings elements",
      "end": "(')",
      "name": "string.source.ChatScript",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "string.source.ChatScript"
        }
      ]
    },
    {
      "comment": "Strings single quotes elements",
      "match": "(\\^(').+('))",
      "name": "string.source.ChatScript"
    },
    {
      "comment": "Wildcard operator",
      "match": "\\*\\~?\\d",
      "name": "keyword.numeric.ChatScript"
    },
    {
      "begin": "(concept:).*\\(",
      "beginCaptures": {
        "1": {
          "name": "entity.name.function.ChatScript"
        }
      },
      "comment": "Concepts",
      "end": "\\)",
      "name": "none.ChatScript",
      "patterns": [
        {
          "include": "$self"
        },
        {
          "match": ".",
          "name": "none.ChatScript"
        }
      ]
    },
    {
      "comment": "Describe",
      "match": "(describe:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Outputmacro",
      "match": "(outputmacro:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Patternmacro",
      "match": "(patternmacro:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Dualmacro",
      "match": "(dualmacro:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Table",
      "match": "(table:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Table",
      "match": "(query:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Rename",
      "match": "(rename:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Topic",
      "match": "(topic:)",
      "name": "entity.name.function.ChatScript"
    },
    {
      "comment": "Conditional compilation",
      "match": "(\\#\\#<<(?i:(ENGLISH|FRENCH|GERMAN|SPANISH))+)",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Conditional compilation single line",
      "match": "(\\#(?i:(ENGLISH|FRENCH|GERMAN|SPANISH))+)",
      "name": "constant.language.ChatScript"
    },
    {
      "begin": "(\\#\\#<<)",
      "comment": "Multiline comments",
      "end": "(\\#\\#>>)",
      "name": "comment.line.number-sign.ChatScript"
    },
    {
      "comment": "Conditional compilation end",
      "match": "(\\#\\#>>)",
      "name": "constant.language.ChatScript"
    },
    {
      "comment": "Comments",
      "match": "(\\#(\\s|#)+.*)|(\\#!(\\s)+.*)|(\\#!x(\\s|#).*)",
      "name": "comment.line.number-sign.ChatScript"
    }
  ],
  "scopeName": "source.top",
  "uuid": "217a687b-ce56-4078-8034-5b1303f17a77"
}
